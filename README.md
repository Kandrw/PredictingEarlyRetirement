## Проект "Прогнозирование раннего выхода на пенсию" от компании Негосударственный пенсионный фонд «БУДУЩЕЕ»

### Наша команда `ИИнтеграция`

<ul>
    <li><a href = "https://t.me/sherokiddo">Брагин Кирилл - Тимлид</a></li>
    <li><a href = "https://t.me/neznayka08">Шушаков Александр - Ml-engineer</a></li>
    <li><a href = "https://t.me/kartavuwu">Кацуро Михаил - Ml-engineer</a></li>
    <li><a href = "https://t.me/xohxh">Нейдорф Павел - Front</a></li>
    <li><a href = "https://t.me/plasmoud">Карпенко Андрей - Back</a></li>
</ul>

## Описание кейса

В рамках всероссийского хакатона "Цифрового прорыва" 2024 в Нижнем Новгороде необходимо было решить кейс "Прогнозирование раннего выхода на пенсию"

> Ключевую роль в досрочном выходе на пенсию играет состояние здоровья клиента. Здоровье клиентов напрямую влияет на их способность продолжать трудовую деятельность. Физические или психологические проблемы могут вынудить клиента уйти на пенсию раньше установленного срока, что увеличивает нагрузку на государственные и частные пенсионные системы. На основе данных о состоянии здоровья и других характеристик участников предстоит разработать модель, которая позволит предсказать вероятность досрочного выхода на пенсию. Это позволит пенсионным фондам и государственным учреждениям учитывать риски и планировать финансовые обязательства более точно.

## Подготовка

Перед проведением хакатона, изучили проблематику кейса и сразу было понятно, что данная задача относятся к задаче таргетирования.

Для данной задачи

* Изменена кодировка данных на UTF-8 для обеспечения совместимости.

* Реализован кастомный алгоритм кросс-валидации `BlockedTimeSeriesSplit`, оптимизированный под данные с временной зависимостью.

* Настроен поиск гиперпараметров с использованием `GridSearchCV` и кастомного `BlockedTimeSeriesSplit` для учета особенностей временных рядов.

* Применен энкодинг для категориальных переменных.

## Хакатон

Во время хакатона компания Негосударственный пенсионный фонд «БУДУЩЕЕ» предоставила нам данные в формате `csv`.

* Файл **cntrbtrs_clnts_ops_trn.csv** --- информация о счетах и соответствующих клиентах.
* Файл **trnsctns_ops_trn.csv** --- транзакции за различные моменты времени клиентов.
* Файл **dst_dscrptn.docx** --- описание полей соответствующих таблиц.

> Входные данные содержат набор признаков 
для каждого клиента, отражающий 
демографические данные, информацию о 
счетах, периоде накопления и статусе 
пенсионного договора. Каждая запись 
представляет собой уникальные данные клиента, 
актуальные на момент подготовки данных.

> Результатом работы модели должно стать 
предсказание вероятности досрочного выхода 
на пенсию (значение от 0 до 1) для каждого 
клиента. Модель оценивается по метрике F1 
для определения её качества и применимости.

Ключевую роль в прогнозировании досрочного выхода на пенсию играет детальный анализ клиентских характеристик. Данные, собранные по различным признакам, позволяют более точно предсказать вероятность выхода клиента на пенсию раньше установленного законом возраста.

Однако работа с такими данными сопряжена с определенными вызовами:

* Недостаток данных — наличие пропусков или неявных значений в некоторых полях может затруднить анализ.
* Сложность интерпретации — многомерные данные требуют продвинутых методов анализа для выявления истинных взаимосвязей.
* Региональные различия — особенности различных регионов могут влиять на поведение клиентов и их пенсионные предпочтения.

Для решения этой задачи необходимо использовать модели машинного обучения, которые способны учитывать влияние различных факторов на вероятность досрочного выхода на пенсию. Например, такие поля как prsnt_age, pnsn_age и rgn могут оказать значительное влияние на результаты. Это позволит компании оптимизировать свои финансовые обязательства и адаптировать пенсионные программы под потребности клиентов.Однако работа с такими данными сопряжена с определенными вызовами:

* Недостаток данных — наличие пропусков или неявных значений в некоторых полях может затруднить анализ.
* Сложность интерпретации — многомерные данные требуют продвинутых методов анализа для выявления истинных взаимосвязей.
* Региональные различия — особенности различных регионов могут влиять на поведение клиентов и их пенсионные предпочтения.

Для решения этой задачи необходимо использовать модели машинного обучения, которые способны учитывать влияние различных факторов на вероятность досрочного выхода на пенсию. Например, такие поля как prsnt_age, pnsn_age и rgn могут оказать значительное влияние на результаты. Это позволит компании оптимизировать свои финансовые обязательства и адаптировать пенсионные программы под потребности клиентов.

## Решение

### Запуск

У нас есть докер для удобства запуска модели.

Необохимо ввести команду 
```
./run.sh -s
./run.sh -r 
```

* флаг -s необходим для сборки контейнера, он запустит докер и начнет загружать библиотеки, это необходимо сделать 1 раз
* флаг -с запускает ускоренную пересборку контейнера, если уже до этого сборка осуществлялась
* флаг -r запускает контейнер
* флаг -b запускает jupyter в контейнере

Далее необходимо будет скопировать из ссылку на юпитер и вставим ее в браузере, то у нас откроется наш файл `sample.ipynb`

### Использование

![изображение](https://github.com/Kandrw/PredictingEarlyRetirement/tree/main/assets/1.png)
